
<div class="container">
    <div class="panel panel-danger" ng-show="errorMessage">
        <div class="panel-heading">There was an error processing your request.</div>
        <div class="panel-body">{{errorMessage}}</div>
    </div>
    <p class="text-muted small" ng-show="proposal.mainCategory">{{proposal.mainCategory}} - {{proposal.subCategory}}</p>
    <div class="jumbotron-product clearfix">
        <div class="half">
            <a href="#" class="small" data-container="body" data-toggle="popover" data-placement="top" data-content="{{proposal.contractAddress}}">
                Smart Contact Address
            </a>
            <h2>
                {{proposal.productName}}
            </h2>
            <p class="lead">{{proposal.productDescription}}</p>
            <p ng-show="proposal.productSku">SKU: <span class="text-muted">{{proposal.productSku}}</span></p>
            <p ng-show="proposal.productUnitSize">Unit size: <span class="text-muted">{{proposal.productUnitSize}}</span></p>
            <p>
                Maximum price: <span class="text-muted">{{(proposal.maxPrice || 0) | number: 2}} GBP</span>
            </p>
            <p>
                End date: <span class="text-muted">{{proposal.endDate | amDateFormat:'DD-MM-YYYY HH:mm:ss'}}</span>
            </p>
            <p>
                Ultimate delivery date: <span class="text-muted">{{proposal.ultimateDeliveryDate | amDateFormat:'DD-MM-YYYY HH:mm:ss'}}</span>
            </p>
            <p class="small text-muted">
                Promote this BuyCo in your network to get more people on board!
            </p>
            <a twitter data-lang="en" data-count='horizontal' data-url='{{pageUrl}}' data-size="medium" data-text='Join me to buy {{proposal.productName}} together using @buycoio!'></a>
        </div>
        <div class="half half-branded">
            <!-- <img src="/data/category/{{proposal.mainCategory}}/{{proposal.subCategory}}/main.jpg"> -->
            <div class="bgimage" style="background-image:url(../data/category/{{proposal.mainCategory | spaceless}}/{{proposal.subCategory | spaceless}}/main.jpg)"></div>
            <p ng-cloak ng-show="!proposal.isClosed && proposal.endDate">Time left to get your orders in:</p>
            <h1 class="timer" ng-cloak ng-show="!proposal.isClosed && proposal.endDate">
                <timer max-time-unit="day" end-time="proposal.endDate">
                    <div class="timer-labels">
                        <span class="timer-time">
                            {{ddays}}
                            <span class="timer-label text-muted">Days</span>
                        </span>
                        <span class="timer-time timer-break">:</span>
                        <span class="timer-time">
                            {{hhours}}
                            <span class="timer-label text-muted">Hours</span>
                        </span>
                        <span class="timer-time timer-break">:</span>
                        <span class="timer-time">
                            {{mminutes}}
                            <span class="timer-label text-muted">Minutes</span>
                        </span>
                        <span class="timer-time timer-break">:</span>
                        <span class="timer-time">
                            {{sseconds}}
                            <span class="timer-label text-muted">Seconds</span>
                        </span>
                    </div>
                </timer>
            </h1>
            <form role="form" name="proposalForm" novalidate>
                <a href="/proposal/{{proposal.contractAddress}}/back" class="btn btn-primary btn-block" ng-show="$root.userInfo.preferences.perspective=='buyer' && !proposal.isClosed">
                    Buy together
                </a>
                <a href="/proposal/{{proposal.contractAddress}}/offer/new" class="btn btn-primary btn-block" ng-show="$root.userInfo.preferences.perspective=='seller' && !proposal.isClosed">
                    Make an offer
                </a>
            </form>
        </div>
    </div>
    <div class="panel panel-default">
        <div class="panel-heading">
            Backers
        </div>
        <div class="panel-body" ng-hide="backers">
            Loading the list of prospective buyers...
        </div>
        <div class="panel-body" ng-show="backers.length == 0">
            <p>You can be the first to back this proposal!</p>
        </div>
        <div class="panel-body" ng-show="backers.length > 0">
            <div class="list-group">
                <p href="#" ng-repeat="backer in backers track by backer.backerIndex" class="list-group-item">
                    Address <code>{{backer.address}}</code><span ng-show="backer.startPaymentTransactionId"> (<a href="https://uphold.com/reserve/transactions/{{backer.startPaymentTransactionId}}" target="_blank">see initial payment</a>)</span>:
                    <span class="pull-right text-muted">{{backer.amount}} unit(s)</span>
                    <!-- TODO: only display this when delivery has been reported (now included as demo) -->
                    <span class="pull-right text-muted">&nbsp;<i class="fa fa-check-square"></i> <strong>delivery reported</strong>&nbsp;</span>
                </p>
            </div>
        </div>
    </div>
    <div class="panel panel-default">
        <div class="panel-heading">
            Offers
        </div>
        <div class="panel-body" ng-hide="offers">
            Loading the list of offers...
        </div>
        <div class="panel-body" ng-show="offers.length == 0">
            <p>
                We're waiting for the first offer. Promote this BuyCo in your network to get more people on board!
            </p>
            <p><a twitter data-lang="en" data-count='horizontal' data-url='{{pageUrl}}' data-size="medium" data-text='Join me to buy {{proposal.productName}} together using @buycoio!'></a></p>
        </div>
        <div class="panel-body" ng-show="offers.length > 0">
            <div class="list-group">
                <p href="#" ng-repeat="offer in offers track by offer.id" class="list-group-item">
                    <!-- TODO: fill in real seller name -->
                    {{offer.sellerName}} (<code>{{offer.sellerAddress}}</code>) offers {{(offer.price || 0) | number :2}} GBP <span class="pull-right text-muted">minimum amount {{offer.minimumAmount}} unit(s)</span>
                    <span class="small"><strong>this is the accepted offer</strong></span>
                    <a href="/proposal/{{proposal.contractAddress}}/offer/{{offer.id}}" class="btn btn-primary">
                        See the offer
                    </a>

                </p>
            </div>
        </div>
    </div>
</div>
<script>
    $(function () {
        $('[data-toggle="popover"]').popover({
            template: '<div class="popover popover-wide" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>'
        });
    });
</script>